dependencies:
  pre:
    - case $CIRCLE_NODE_INDEX in 0) NODE_VERSION=8 ;; esac; nvm install $NODE_VERSION && nvm alias default $NODE_VERSION
  override:
    - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test && sudo apt-get update
    - sudo apt-get install -y gcc-6 g++-6
    - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-6 20
    - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-6 20
    - g++ --version
    - rm -rf node_modules
    - npm install

test:
  override:
    - ./test/ci-test.sh:
        parallel: true
        timeout: 1200
